- model: 1D
  description: Meta-train and test CNP, NP, ANP, MAML, meta-GPR.
  sourcecode:
    - '*.py'
    - guild.yml
  operations:
    train-np:
      description: Meta-train and test NP
      main: run_1D_experiments
      output-scalars: no
      compare:
        - step
        - Eval/log_likelihood
        - Eval/rmse
        - Eval/calibr_error
        - .time
        - .started
        - =n_train_samples
        - =n_train_tasks
        - =n_test_context_samples
      flags:
        meta_learner: 'neural_process'
        dataset: 'sin'
        random_seed: 25
        num_iter_fit: 1000
        task_batch_size: 4
        lr_decay: 0.97
        lr_params: 1e-3
        h_dim: 128
        weight_decay: 1e-3
        n_train_tasks: 100
        n_train_samples: 50
        n_test_context_samples: 5

    train-all-np:
      description: Meta-train and test NP
      main: run_1D_experiments
      output-scalars: no
      flags:
        meta_learner: ['neural_process','conditional_neural_process', 'attentive_conditional_neural_process', 'attentive_neural_process']
        dataset: 'sin'
        random_seed: [25, 26, 27]
        num_iter_fit: 1000
        task_batch_size: [4, 16]
        lr_decay: [0.97, 0.98, 0.99, 1]
        lr_params: [5e-3, 1e-3, 5e-4, 1e-4, 1e-5]
        h_dim: 128
        weight_decay: [1e-4, 1e-3, 1e-2]
        n_train_tasks: [100, 1000]
        n_train_samples: [25, 50, 100, 250]
        n_test_context_samples: 5

    train-meta-gpr:
      main: run_1D_experiments
      flags:
        meta_learner: 'gpr_meta_mll'
        dataset: 'sin'
        random_seed: 25
        covar_module: NN
        mean_module: NN
        num_iter_fit: 1000
        weight_decay: 0.0
        task_batch_size: 4
        lr_decay: 0.97
        lr_params: 1e-3
        mean_nn_layers: 32,32,32,32
        kernel_nn_layers: 32,32,32,32
        n_train_tasks: 100
        n_train_samples: 50
        n_test_context_samples: 5
